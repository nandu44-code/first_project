{% extends 'accounts/base.html' %}
{% load static %}
<!-- Start Header/Navigation -->
{% block bootstraplink %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- <style>
    .btn variant-button.clicked {
        
        border:5px;
        border-style: solid;
        border-color: white
        
        /* Scale the button up by 20% when clicked */
    }
</style> -->

{% endblock %}

{% block content %}

<div class="container mt-5">

    <div class="row d-flex justify-content-center">
        <!-- Main Product Image -->

        <div class="col-sm-6 mx-auto vertical-align">

            <div class="col-md-6">
                <!-- Main Product Image -->
                <img src="/media/{{variant.image1}}" id="image_1" class="img-fluid" width="140%">
            </div>
            <!-- Small Images Container -->
            <div class="d-flex flex-row col-md-6 ">
                <!-- Small Images -->
                <div class="small-image mt-3 mb-5">
                    <img src="/media/{{variant.image2}}"class="sub-image" alt="Small Image 1" id="image_2" class="img-fluid small-img"
                        style="width: 100%;" onclick="swapMainWithSubImage(this);">
                </div>
                <div class="small-image  mt-3 mb-2">
                    <img src="/media/{{variant.image3}}" class="sub-image" alt="Small Image 2" id="image_3" class="img-fluid small-img"
                        style="width: 100%;" onclick="swapMainWithSubImage(this);">
                </div>
                <div class="small-image  mt-3 mb-2">
                    <img src="/media/{{variant.image4}}" class="sub-image" alt="Small Image 3" id="image_4" class="img-fluid small-img"
                        style="width: 100%;" onclick="swapMainWithSubImage(this);">
                </div>
            </div>
        </div>
        <!-- Product Details -->
        <div class="col-sm-6 mb-5 ">
 
            <h2 style="color:black; font-weight:bolder">{{variant.product.product_name}}</h2>

            <div class="d-flex align-items-center mt-3">

                <h4><strong>Rs.</strong></h3>

                    <h4 class="mr-2" id="price" style="color:red" mb-3 !important">{{variant.selling_price}}</h4>
                    <h6 ><del style="color:rgb(86, 85, 85)">{{variant.actual_price}}</del></h6>
            </div>


            {% if product.stock == 0 %}
            <button class="btn btn-danger-sm mb-3">Out of stock</button>
            <p class="sorry_msg">Sorry, for this inconvinence</p>
            {% else %}
            <div class="d-flex mt-3">
                <h5 style="color:black" id="stock">{{variant.stock}}</h5><h5 style="padding-left:10px; padding-right:6px;">   Items In <span style="color:blue">Stock</span></h5>
            </div>
           
            
            {% endif %}
            <h5 class="mt-4" style="color:rgb(49, 36, 36)">Available Vatiants</h5>
            <div class="d-flex">


                {% for variants in available_variants %}

                <div class="d-flex mr-5 mb-5 mt-1 ">
                    <button type="button" class="btn variant-button" id="variant-selector-{{ variants.id }}"
                        data-variant-id="{{ variants.id }}"
                        style=" background: {{ variants.color }} ; margin-right:5px; width: 10px; height:10px;">

                    </button>
                </div>
                {% endfor %}
            </div>  

            <!-- Buttons -->
            <div class="mt-3">

                <a href="{% url 'add_cart' product_id=variant.id %}">
                    <button class="btn btn-sm button-addtocart">Add to Cart</button>
                </a>
                <button class="btn btn-primary">Buy Now</button>
            </div>
        

        <h5 class="mt-4" style="color:brown">About this Item :</h5>
        <p>{{variant.product.description}}</p>




    </div>
    </div>
</div>




{% endblock %}

{% block script %}
<script>
    $(document).ready(function () {
        // Attach a click event handler to all buttons with the 'variant-button' class
        $(".variant-button").click(function () {
            var variantId = $(this).data("variant-id");
            console.log(variantId)
            console.log(".......................................");
            $.ajax({
                type: "GET", // You can change this to GET or any other method
                url: "/home/variant_select/" + variantId + "/", // Replace with your actual backend endpoint
                //data: { variant_id: variantId }, // Send the variantId as data -->
                success: function (response) {
                    $('#price').text(response.variant)
                    $('#stock').text(response.variant_stock)
                    $('#image_1').attr("src",response.variant_image1);
                    $('#image_2').attr("src",response.variant_image2);
                    $('#image_3').attr("src",response.variant_image3);
                    $('#image_4').attr("src",response.variant_image4);

                    console.log(response);


                },
                error: function () {
                    // Handle errors (if any)
                    console.log("Error sending Variant ID.");
                }
            });

        });
    });
</script>
<script>
    function swapMainWithSubImage(subImage) {
        // Get the current main image and sub-image sources
        var mainImage = document.getElementById("image_1");
        var mainImageSrc = mainImage.getAttribute("src");
        var subImageSrc = subImage.getAttribute("src");

        // Set the main image source to the clicked sub-image source
        mainImage.setAttribute("src", subImageSrc);

        // Set the clicked sub-image source to the previous main image source
        subImage.setAttribute("src", mainImageSrc);
    }
</script>



<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>


{% endblock %}